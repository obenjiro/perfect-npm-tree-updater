var dt=Object.defineProperty;var D=(e,t)=>()=>(e&&(t=e(e=0)),t);var K=(e,t)=>{for(var n in t)dt(e,n,{get:t[n],enumerable:!0})};var Ne={};K(Ne,{cachePacument:()=>ye,clearCache:()=>pt,getCacheStats:()=>xe,getCachedPacument:()=>be});async function ie(){return Z?P||new Promise((e,t)=>{let n=indexedDB.open(Le,1);n.onerror=()=>{console.error("\u274C Failed to open IndexedDB:",n.error),t(n.error)},n.onsuccess=()=>{P=n.result,console.log("\u2705 IndexedDB initialized"),e(P)},n.onupgradeneeded=r=>{let s=r.target.result;s.objectStoreNames.contains(B)||(s.createObjectStore(B,{keyPath:"packageName"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("\u{1F4E6} Created pacuments object store"))}}):Promise.resolve("memory-cache")}async function ye(e,t){try{if(await ie(),!Z){let o={packageName:e,data:t,timestamp:Date.now()};Y.set(e,o),console.log(`\u{1F4BE} Cached pacument for ${e} (memory)`);return}let r=P.transaction([B],"readwrite").objectStore(B),s={packageName:e,data:t,timestamp:Date.now()};await new Promise((o,a)=>{let i=r.put(s);i.onsuccess=()=>o(),i.onerror=()=>a(i.error)}),console.log(`\u{1F4BE} Cached pacument for ${e}`)}catch(n){console.error(`\u274C Failed to cache pacument for ${e}:`,n)}}async function be(e){try{if(await ie(),!Z){let o=Y.get(e);if(!o)return console.log(`\u{1F4E6} No cache for ${e} (memory)`),null;let a=Date.now()-o.timestamp;return a>864e5?(console.log(`\u23F0 Cache expired for ${e} (${Math.round(a/1e3/60)} minutes old, memory)`),Y.delete(e),null):(console.log(`\u2705 Using cached pacument for ${e} (memory)`),o.data)}let n=P.transaction([B],"readonly").objectStore(B),r=await new Promise((o,a)=>{let i=n.get(e);i.onsuccess=()=>o(i.result),i.onerror=()=>a(i.error)});if(!r)return console.log(`\u{1F4E6} No cache for ${e}`),null;let s=Date.now()-r.timestamp;return s>864e5?(console.log(`\u23F0 Cache expired for ${e} (${Math.round(s/1e3/60)} minutes old)`),ut(e),null):(console.log(`\u2705 Using cached pacument for ${e}`),r.data)}catch(t){return console.error(`\u274C Failed to get cached pacument for ${e}:`,t),null}}async function ut(e){try{if(!Z){Y.delete(e);return}P.transaction([B],"readwrite").objectStore(B).delete(e)}catch(t){console.error(`\u274C Failed to cleanup expired cache for ${e}:`,t)}}async function pt(){try{if(await ie(),!Z){Y.clear(),console.log("\u{1F9F9} Cache cleared (memory)");return}let t=P.transaction([B],"readwrite").objectStore(B);await new Promise((n,r)=>{let s=t.clear();s.onsuccess=()=>n(),s.onerror=()=>r(s.error)}),console.log("\u{1F9F9} Cache cleared")}catch(e){throw console.error("\u274C Failed to clear cache:",e),e}}async function xe(){try{if(await ie(),!Z)return{entries:Y.size,dbName:"memory-cache",storeName:"in-memory",cacheDuration:864e5};let t=P.transaction([B],"readonly").objectStore(B);return{entries:await new Promise((r,s)=>{let o=t.count();o.onsuccess=()=>r(o.result),o.onerror=()=>s(o.error)}),dbName:Le,storeName:B,cacheDuration:864e5}}catch(e){return console.error("\u274C Failed to get cache stats:",e),{entries:0,error:e.message}}}var Le,B,P,Z,Y,ae=D(()=>{Le="kiwi-updater-cache",B="pacuments",P=null,Z=typeof window<"u"&&typeof indexedDB<"u",Y=new Map});var Fe={};K(Fe,{areConstraintsCompatible:()=>ft,getAvailableVersionNumbers:()=>mt,intersectConstraints:()=>gt,numberToVersion:()=>x,parseSemverConstraint:()=>C,versionToNumber:()=>y});function y(e){if(!e)return 0;let n=e.replace(/^[\^~>=<]+/,"").replace(/-.*$/,"").replace(/\+.*$/,"").trim().split("."),r=parseInt(n[0]||"0",10),s=parseInt(n[1]||"0",10),o=parseInt(n[2]||"0",10);return r*1e4+s*100+o}function x(e){if(!e||e<0)return"0.0.0";let t=Math.floor(e/1e4),n=Math.floor(e%1e4/100),r=e%100;return`${t}.${n}.${r}`}function C(e){if(console.log(`\u{1F50D} DEBUG: parseSemverConstraint called with: "${e}"`),!e||e.trim()==="")throw new Error("Empty or invalid constraint");let t=e.trim();if(t.includes("||")){let r=t.split("||").map(a=>a.trim()),s=Number.MAX_SAFE_INTEGER,o=0;for(let a of r){let i=C(a);s=Math.min(s,i.min),o=Math.max(o,i.max)}return{min:s,max:o}}if(t.includes(" ")){let r=t.split(/\s+/).filter(o=>o.length>0),s=!1;if(r.length>1&&(s=r.every(o=>/^[\^~]\d+\.\d+\.\d+/.test(o)||/^>=\d+\.\d+\.\d+/.test(o)||/^>\d+\.\d+\.\d+/.test(o)||/^<=\d+\.\d+\.\d+/.test(o)||/^<\d+\.\d+\.\d+/.test(o)||/^\d+\.\d+\.\d+/.test(o))),s){let o=0,a=Number.MAX_SAFE_INTEGER;for(let i of r){let c=C(i);o=Math.max(o,c.min),a=Math.min(a,c.max)}return{min:o,max:a}}t=r.join("")}if(!t.match(/^[\^~>=<]/)){if(t==="*")return{min:0,max:Number.MAX_SAFE_INTEGER};if(!/^\d+(?:\.\d+)?(?:\.\d+)?(-[a-zA-Z0-9.-]+)?$/.test(t))throw console.error(`\u{1F6A8} DEBUG: parseSemverConstraint called with invalid version: "${t}"`),console.error("\u{1F6A8} DEBUG: Stack trace:",new Error().stack),new Error(`Invalid version format: ${t}`);if(!/^\d+\.\d+\.\d+/.test(t)){console.warn(`\u26A0\uFE0F parseSemverConstraint received partial version "${t}" - this should be resolved first`);let s=t.split("."),o=parseInt(s[0]),a=s[1]!==void 0?parseInt(s[1]):0,i=s[2]!==void 0?parseInt(s[2]):0;if(s.length===1){let c=y(`${o}.0.0`),u=y(`${o}.99999.99999`);return{min:c,max:u}}else if(s.length===2){let c=y(`${o}.${a}.0`),u=y(`${o}.${a}.99999`);return{min:c,max:u}}}let r=y(t);return{min:r,max:r}}if(t.startsWith("^")){let r=t.substring(1);if(!/^\d+(?:\.\d+)?(?:\.\d+)?(-[a-zA-Z0-9.-]+)?$/.test(r))throw new Error(`Invalid caret constraint: ${t}`);let s=r,o=r.split(".");o.length===1?s=`${o[0]}.0.0`:o.length===2&&(s=`${o[0]}.${o[1]}.0`);let a=`^${s}`,i=y(s),c=Math.floor(i/1e4),u=Math.floor(i%1e4/100),p;return c===0?u===0?p=i:p=c*1e4+(u+1)*100-1:p=(c+1)*1e4-1,console.log(`\u{1F50D} Parsing caret constraint ${t}: ${x(i)} - ${x(p)}`),{min:i,max:p}}if(t.startsWith("~")){let r=t.substring(1);if(!/^\d+(?:\.\d+)?(?:\.\d+)?(-[a-zA-Z0-9.-]+)?$/.test(r))throw new Error(`Invalid tilde constraint: ${t}`);let s=r,o=r.split(".");o.length===1?s=`${o[0]}.0.0`:o.length===2&&(s=`${o[0]}.${o[1]}.0`);let a=y(s),i=Math.floor(a/1e4),c=Math.floor(a%1e4/100);return{min:a,max:i*1e4+(c+1)*100-1}}if(t.startsWith(">="))return{min:y(t.substring(2)),max:Number.MAX_SAFE_INTEGER};if(t.startsWith(">")&&!t.startsWith(">="))return{min:y(t.substring(1))+1,max:Number.MAX_SAFE_INTEGER};if(t.startsWith("<="))return{min:0,max:y(t.substring(2))};if(t.startsWith("<")&&!t.startsWith("<="))return{min:0,max:y(t.substring(1))-1};let n=y(t);return{min:n,max:n}}function ft(e,t){let n=C(e),r=C(t);return n.min<=r.max&&r.min<=n.max}function gt(e,t){let n=C(e),r=C(t),s=Math.max(n.min,r.min),o=Math.min(n.max,r.max);return s<=o?{min:s,max:o}:null}function mt(e){return e.versions?Object.keys(e.versions).map(t=>({version:t,number:y(t)})).sort((t,n)=>t.number-n.number):[]}var G=D(()=>{});function U(){return new ht}var ht,Ue,$e=D(()=>{ht=(function(){function e(){this.index={},this.array=[]}return e.prototype.size=function(){return this.array.length},e.prototype.empty=function(){return this.array.length===0},e.prototype.itemAt=function(t){return this.array[t]},e.prototype.contains=function(t){return this.index[t.id()]!==void 0},e.prototype.find=function(t){var n=this.index[t.id()];return n===void 0?void 0:this.array[n]},e.prototype.setDefault=function(t,n){var r=this.index[t.id()];if(r===void 0){var s=new Ue(t,n());return this.index[t.id()]=this.array.length,this.array.push(s),s}else return this.array[r]},e.prototype.insert=function(t,n){var r=new Ue(t,n),s=this.index[t.id()];return s===void 0?(this.index[t.id()]=this.array.length,this.array.push(r)):this.array[s]=r,r},e.prototype.erase=function(t){var n=this.index[t.id()];if(n!==void 0){this.index[t.id()]=void 0;var r=this.array[n],s=this.array.pop();return r!==s&&(this.array[n]=s,this.index[s.first.id()]=n),r}},e.prototype.copy=function(){for(var t=new e,n=0;n<this.array.length;n++){var r=this.array[n].copy();t.array[n]=r,t.index[r.first.id()]=n}return t},e})(),Ue=(function(){function e(t,n){this.first=t,this.second=n}return e.prototype.copy=function(){return new e(this.first,this.second)},e})()});var W,vt,we=D(()=>{ee();W=(function(){function e(t){t===void 0&&(t=""),this._value=0,this._context=null,this._id=vt++,this._name=t}return e.prototype.id=function(){return this._id},e.prototype.name=function(){return this._name},e.prototype.setName=function(t){this._name=t},e.prototype.context=function(){return this._context},e.prototype.setContext=function(t){this._context=t},e.prototype.value=function(){return this._value},e.prototype.setValue=function(t){this._value=t},e.prototype.plus=function(t){return new z(this,t)},e.prototype.minus=function(t){return new z(this,typeof t=="number"?-t:[-1,t])},e.prototype.multiply=function(t){return new z([t,this])},e.prototype.divide=function(t){return new z([1/t,this])},e.prototype.toJSON=function(){return{name:this._name,value:this._value}},e.prototype.toString=function(){return this._context+"["+this._name+":"+this._value+"]"},e})(),vt=0});function yt(e){for(var t=0,n=function(){return 0},r=U(),s=0,o=e.length;s<o;++s){var a=e[s];if(typeof a=="number")t+=a;else if(a instanceof W)r.setDefault(a,n).second+=1;else if(a instanceof z){t+=a.constant();for(var i=a.terms(),c=0,u=i.size();c<u;c++){var p=i.itemAt(c);r.setDefault(p.first,n).second+=p.second}}else if(a instanceof Array){if(a.length!==2)throw new Error("array must have length 2");var l=a[0],d=a[1];if(typeof l!="number")throw new Error("array item 0 must be a number");if(d instanceof W)r.setDefault(d,n).second+=l;else if(d instanceof z){t+=d.constant()*l;for(var i=d.terms(),c=0,u=i.size();c<u;c++){var p=i.itemAt(c);r.setDefault(p.first,n).second+=p.second*l}}else throw new Error("array item 1 must be a variable or expression")}else throw new Error("invalid Expression argument: "+a)}return{terms:r,constant:t}}var z,ee=D(()=>{$e();we();z=(function(){function e(){var t=yt(arguments);this._terms=t.terms,this._constant=t.constant}return e.prototype.terms=function(){return this._terms},e.prototype.constant=function(){return this._constant},e.prototype.value=function(){for(var t=this._constant,n=0,r=this._terms.size();n<r;n++){var s=this._terms.itemAt(n);t+=s.first.value()*s.second}return t},e.prototype.plus=function(t){return new e(this,t)},e.prototype.minus=function(t){return new e(this,typeof t=="number"?-t:[-1,t])},e.prototype.multiply=function(t){return new e([t,this])},e.prototype.divide=function(t){return new e([1/t,this])},e.prototype.isConstant=function(){return this._terms.size()==0},e.prototype.toString=function(){var t=this._terms.array.map(function(n){return n.second+"*"+n.first.toString()}).join(" + ");return!this.isConstant()&&this._constant!==0&&(t+=" + "),t+=this._constant,t},e})()});var $,ce=D(()=>{$=(function(){function e(){}return e.create=function(t,n,r,s){s===void 0&&(s=1);var o=0;return o+=Math.max(0,Math.min(1e3,t*s))*1e6,o+=Math.max(0,Math.min(1e3,n*s))*1e3,o+=Math.max(0,Math.min(1e3,r*s)),o},e.clip=function(t){return Math.max(0,Math.min(e.required,t))},e.required=e.create(1e3,1e3,1e3),e.strong=e.create(1,0,0),e.medium=e.create(0,1,0),e.weak=e.create(0,0,1),e})()});var k,E,bt,ke=D(()=>{ee();ce();(function(e){e[e.Le=0]="Le",e[e.Ge=1]="Ge",e[e.Eq=2]="Eq"})(k||(k={}));E=(function(){function e(t,n,r,s){s===void 0&&(s=$.required),this._id=bt++,this._operator=n,this._strength=$.clip(s),r===void 0&&t instanceof z?this._expression=t:this._expression=t.minus(r)}return e.prototype.id=function(){return this._id},e.prototype.expression=function(){return this._expression},e.prototype.op=function(){return this._operator},e.prototype.strength=function(){return this._strength},e.prototype.toString=function(){return this._expression.toString()+" "+["<=",">=","="][this._operator]+" 0 ("+this._strength.toString()+")"},e})(),bt=0});function le(e){var t=1e-8;return e<0?-e<t:e<t}function xt(){return U()}function $t(){return U()}function wt(){return U()}function kt(){return U()}var Ce,b,He,O,Oe,Xe=D(()=>{ke();ee();$e();ce();Ce=(function(){function e(){this.maxIterations=1e3,this._cnMap=xt(),this._rowMap=$t(),this._varMap=wt(),this._editMap=kt(),this._infeasibleRows=[],this._objective=new Oe,this._artificial=null,this._idTick=0}return e.prototype.createConstraint=function(t,n,r,s){s===void 0&&(s=$.required);var o=new E(t,n,r,s);return this.addConstraint(o),o},e.prototype.addConstraint=function(t){var n=this._cnMap.find(t);if(n!==void 0)throw new Error("duplicate constraint");var r=this._createRow(t),s=r.row,o=r.tag,a=this._chooseSubject(s,o);if(a.type()===b.Invalid&&s.allDummies())if(le(s.constant()))a=o.marker;else throw new Error("unsatisfiable constraint");if(a.type()===b.Invalid){if(!this._addWithArtificialVariable(s))throw new Error("unsatisfiable constraint")}else s.solveFor(a),this._substitute(a,s),this._rowMap.insert(a,s);this._cnMap.insert(t,o),this._optimize(this._objective)},e.prototype.removeConstraint=function(t){var n=this._cnMap.erase(t);if(n===void 0)throw new Error("unknown constraint");this._removeConstraintEffects(t,n.second);var r=n.second.marker,s=this._rowMap.erase(r);if(s===void 0){var o=this._getMarkerLeavingSymbol(r);if(o.type()===b.Invalid)throw new Error("failed to find leaving row");s=this._rowMap.erase(o),s.second.solveForEx(o,r),this._substitute(r,s.second)}this._optimize(this._objective)},e.prototype.hasConstraint=function(t){return this._cnMap.contains(t)},e.prototype.addEditVariable=function(t,n){var r=this._editMap.find(t);if(r!==void 0)throw new Error("duplicate edit variable");if(n=$.clip(n),n===$.required)throw new Error("bad required strength");var s=new z(t),o=new E(s,k.Eq,void 0,n);this.addConstraint(o);var a=this._cnMap.find(o).second,i={tag:a,constraint:o,constant:0};this._editMap.insert(t,i)},e.prototype.removeEditVariable=function(t){var n=this._editMap.erase(t);if(n===void 0)throw new Error("unknown edit variable");this.removeConstraint(n.second.constraint)},e.prototype.hasEditVariable=function(t){return this._editMap.contains(t)},e.prototype.suggestValue=function(t,n){var r=this._editMap.find(t);if(r===void 0)throw new Error("unknown edit variable");var s=this._rowMap,o=r.second,a=n-o.constant;o.constant=n;var i=o.tag.marker,c=s.find(i);if(c!==void 0){c.second.add(-a)<0&&this._infeasibleRows.push(i),this._dualOptimize();return}var u=o.tag.other;if(c=s.find(u),c!==void 0){c.second.add(a)<0&&this._infeasibleRows.push(u),this._dualOptimize();return}for(var p=0,l=s.size();p<l;++p){var d=s.itemAt(p),f=d.second,g=f.coefficientFor(i);g!==0&&f.add(a*g)<0&&d.first.type()!==b.External&&this._infeasibleRows.push(d.first)}this._dualOptimize()},e.prototype.updateVariables=function(){for(var t=this._varMap,n=this._rowMap,r=0,s=t.size();r<s;++r){var o=t.itemAt(r),a=n.find(o.second);a!==void 0?o.first.setValue(a.second.constant()):o.first.setValue(0)}},e.prototype._getVarSymbol=function(t){var n=this,r=function(){return n._makeSymbol(b.External)};return this._varMap.setDefault(t,r).second},e.prototype._createRow=function(t){for(var n=t.expression(),r=new Oe(n.constant()),s=n.terms(),o=0,a=s.size();o<a;++o){var i=s.itemAt(o);if(!le(i.second)){var c=this._getVarSymbol(i.first),u=this._rowMap.find(c);u!==void 0?r.insertRow(u.second,i.second):r.insertSymbol(c,i.second)}}var p=this._objective,l=t.strength(),d={marker:O,other:O};switch(t.op()){case k.Le:case k.Ge:{var f=t.op()===k.Le?1:-1,g=this._makeSymbol(b.Slack);if(d.marker=g,r.insertSymbol(g,f),l<$.required){var h=this._makeSymbol(b.Error);d.other=h,r.insertSymbol(h,-f),p.insertSymbol(h,l)}break}case k.Eq:{if(l<$.required){var v=this._makeSymbol(b.Error),j=this._makeSymbol(b.Error);d.marker=v,d.other=j,r.insertSymbol(v,-1),r.insertSymbol(j,1),p.insertSymbol(v,l),p.insertSymbol(j,l)}else{var w=this._makeSymbol(b.Dummy);d.marker=w,r.insertSymbol(w)}break}}return r.constant()<0&&r.reverseSign(),{row:r,tag:d}},e.prototype._chooseSubject=function(t,n){for(var r=t.cells(),s=0,o=r.size();s<o;++s){var a=r.itemAt(s);if(a.first.type()===b.External)return a.first}var i=n.marker.type();return(i===b.Slack||i===b.Error)&&t.coefficientFor(n.marker)<0?n.marker:(i=n.other.type(),(i===b.Slack||i===b.Error)&&t.coefficientFor(n.other)<0?n.other:O)},e.prototype._addWithArtificialVariable=function(t){var n=this._makeSymbol(b.Slack);this._rowMap.insert(n,t.copy()),this._artificial=t.copy(),this._optimize(this._artificial);var r=le(this._artificial.constant());this._artificial=null;var s=this._rowMap.erase(n);if(s!==void 0){var o=s.second;if(o.isConstant())return r;var a=this._anyPivotableSymbol(o);if(a.type()===b.Invalid)return!1;o.solveForEx(n,a),this._substitute(a,o),this._rowMap.insert(a,o)}for(var i=this._rowMap,c=0,u=i.size();c<u;++c)i.itemAt(c).second.removeSymbol(n);return this._objective.removeSymbol(n),r},e.prototype._substitute=function(t,n){for(var r=this._rowMap,s=0,o=r.size();s<o;++s){var a=r.itemAt(s);a.second.substitute(t,n),a.second.constant()<0&&a.first.type()!==b.External&&this._infeasibleRows.push(a.first)}this._objective.substitute(t,n),this._artificial&&this._artificial.substitute(t,n)},e.prototype._optimize=function(t){for(var n=0;n<this.maxIterations;){var r=this._getEnteringSymbol(t);if(r.type()===b.Invalid)return;var s=this._getLeavingSymbol(r);if(s.type()===b.Invalid)throw new Error("the objective is unbounded");var o=this._rowMap.erase(s).second;o.solveForEx(s,r),this._substitute(r,o),this._rowMap.insert(r,o),n++}throw new Error("solver iterations exceeded")},e.prototype._dualOptimize=function(){for(var t=this._rowMap,n=this._infeasibleRows;n.length!==0;){var r=n.pop(),s=t.find(r);if(s!==void 0&&s.second.constant()<0){var o=this._getDualEnteringSymbol(s.second);if(o.type()===b.Invalid)throw new Error("dual optimize failed");var a=s.second;t.erase(r),a.solveForEx(r,o),this._substitute(o,a),t.insert(o,a)}}},e.prototype._getEnteringSymbol=function(t){for(var n=t.cells(),r=0,s=n.size();r<s;++r){var o=n.itemAt(r),a=o.first;if(o.second<0&&a.type()!==b.Dummy)return a}return O},e.prototype._getDualEnteringSymbol=function(t){for(var n=Number.MAX_VALUE,r=O,s=t.cells(),o=0,a=s.size();o<a;++o){var i=s.itemAt(o),c=i.first,u=i.second;if(u>0&&c.type()!==b.Dummy){var p=this._objective.coefficientFor(c),l=p/u;l<n&&(n=l,r=c)}}return r},e.prototype._getLeavingSymbol=function(t){for(var n=Number.MAX_VALUE,r=O,s=this._rowMap,o=0,a=s.size();o<a;++o){var i=s.itemAt(o),c=i.first;if(c.type()!==b.External){var u=i.second,p=u.coefficientFor(t);if(p<0){var l=-u.constant()/p;l<n&&(n=l,r=c)}}}return r},e.prototype._getMarkerLeavingSymbol=function(t){for(var n=Number.MAX_VALUE,r=n,s=n,o=O,a=o,i=o,c=o,u=this._rowMap,p=0,l=u.size();p<l;++p){var d=u.itemAt(p),f=d.second,g=f.coefficientFor(t);if(g!==0){var h=d.first;if(h.type()===b.External)c=h;else if(g<0){var v=-f.constant()/g;v<r&&(r=v,a=h)}else{var v=f.constant()/g;v<s&&(s=v,i=h)}}}return a!==o?a:i!==o?i:c},e.prototype._removeConstraintEffects=function(t,n){n.marker.type()===b.Error&&this._removeMarkerEffects(n.marker,t.strength()),n.other.type()===b.Error&&this._removeMarkerEffects(n.other,t.strength())},e.prototype._removeMarkerEffects=function(t,n){var r=this._rowMap.find(t);r!==void 0?this._objective.insertRow(r.second,-n):this._objective.insertSymbol(t,-n)},e.prototype._anyPivotableSymbol=function(t){for(var n=t.cells(),r=0,s=n.size();r<s;++r){var o=n.itemAt(r),a=o.first.type();if(a===b.Slack||a===b.Error)return o.first}return O},e.prototype._makeSymbol=function(t){return new He(t,this._idTick++)},e})();(function(e){e[e.Invalid=0]="Invalid",e[e.External=1]="External",e[e.Slack=2]="Slack",e[e.Error=3]="Error",e[e.Dummy=4]="Dummy"})(b||(b={}));He=(function(){function e(t,n){this._id=n,this._type=t}return e.prototype.id=function(){return this._id},e.prototype.type=function(){return this._type},e})(),O=new He(b.Invalid,-1),Oe=(function(){function e(t){t===void 0&&(t=0),this._cellMap=U(),this._constant=t}return e.prototype.cells=function(){return this._cellMap},e.prototype.constant=function(){return this._constant},e.prototype.isConstant=function(){return this._cellMap.empty()},e.prototype.allDummies=function(){for(var t=this._cellMap,n=0,r=t.size();n<r;++n){var s=t.itemAt(n);if(s.first.type()!==b.Dummy)return!1}return!0},e.prototype.copy=function(){var t=new e(this._constant);return t._cellMap=this._cellMap.copy(),t},e.prototype.add=function(t){return this._constant+=t},e.prototype.insertSymbol=function(t,n){n===void 0&&(n=1);var r=this._cellMap.setDefault(t,function(){return 0});le(r.second+=n)&&this._cellMap.erase(t)},e.prototype.insertRow=function(t,n){n===void 0&&(n=1),this._constant+=t._constant*n;for(var r=t._cellMap,s=0,o=r.size();s<o;++s){var a=r.itemAt(s);this.insertSymbol(a.first,a.second*n)}},e.prototype.removeSymbol=function(t){this._cellMap.erase(t)},e.prototype.reverseSign=function(){this._constant=-this._constant;for(var t=this._cellMap,n=0,r=t.size();n<r;++n){var s=t.itemAt(n);s.second=-s.second}},e.prototype.solveFor=function(t){var n=this._cellMap,r=n.erase(t),s=-1/r.second;this._constant*=s;for(var o=0,a=n.size();o<a;++o)n.itemAt(o).second*=s},e.prototype.solveForEx=function(t,n){this.insertSymbol(t,-1),this.solveFor(n)},e.prototype.coefficientFor=function(t){var n=this._cellMap.find(t);return n!==void 0?n.second:0},e.prototype.substitute=function(t,n){var r=this._cellMap.erase(t);r!==void 0&&this.insertRow(n,r.second)},e})()});var We=D(()=>{ke();ee();Xe();ce();we()});var Ye={};K(Ye,{generateCompatibilityReport:()=>Se,resolveSemverConstraint:()=>_e,solvePackageConstraints:()=>qe});function Ct(e){let t=new Set;return e.forEach(n=>{let r=y(n),s=Math.floor(r/1e4);t.add(s)}),Array.from(t).sort((n,r)=>r-n)}function _e(e,t){let n=e.trim();if(console.log(`\u{1F50D} DEBUG: resolveSemverConstraint called with: "${n}"`),n==="*"){if(t.length===0)return{resolvedVersion:null,isConstraint:!0,error:'No available versions found for wildcard "*"'};let s=t[t.length-1];return console.log(`\u{1F3AF} Resolved wildcard "*" to latest version "${s}" from ${t.length} available versions`),{resolvedVersion:s,isConstraint:!0,originalConstraint:"*"}}let r=/^[\^~>=<*]/.test(n)||n.includes(" ")||n.includes("||");if(console.log(`\u{1F50D} DEBUG: isSemverConstraint = ${r}`),!r){let s=n.match(/^(\d+)(?:\.(\d+))?(?:\.(\d+))?$/);if(s){let[,o,a,i]=s;if(!a&&!i){let c=parseInt(o),u=t.filter(d=>{let f=y(d);return Math.floor(f/1e4)===c});if(u.length===0)return{resolvedVersion:null,isConstraint:!0,error:`No versions found for major version ${o}. Available major versions: ${Ct(t).join(", ")}`};let p=u.sort((d,f)=>y(d)-y(f)),l=p[p.length-1];return console.log(`\u{1F3AF} Resolved partial version "${n}" to version "${l}" from ${u.length} candidates`),{resolvedVersion:l,isConstraint:!0,originalConstraint:n}}if(a&&!i){let c=parseInt(o),u=parseInt(a),p=t.filter(f=>{let g=y(f),h=Math.floor(g/1e4),v=Math.floor(g%1e4/100);return h===c&&v===u});if(p.length===0)return{resolvedVersion:null,isConstraint:!0,error:`No versions found for version ${o}.${a}.x`};let l=p.sort((f,g)=>y(f)-y(g)),d=l[l.length-1];return console.log(`\u{1F3AF} Resolved partial version "${n}" to version "${d}" from ${p.length} candidates`),{resolvedVersion:d,isConstraint:!0,originalConstraint:n}}}return{resolvedVersion:n,isConstraint:!1}}try{let s=C(e),o=t.filter(i=>{let c=y(i);return c>=s.min&&c<=s.max});if(o.length===0)return{resolvedVersion:null,isConstraint:!0,error:`No available versions satisfy constraint "${e}"`};let a=o[o.length-1];return console.log(`\u{1F3AF} Resolved semver constraint "${e}" to version "${a}" from ${o.length} candidates`),{resolvedVersion:a,isConstraint:!0,originalConstraint:e}}catch(s){return{resolvedVersion:null,isConstraint:!0,error:`Invalid semver constraint "${e}": ${s.message}`}}}async function qe(e,t){let n=new Ce,r=new Map,s=[],o={solvable:!1,solution:new Map,conflicts:[...e.conflicts||[]],warnings:[],availableVersions:new Map,analysis:{totalPackages:e.packages.size,constraintsCount:0,processingTime:0}},a=performance.now();try{console.log(`\u{1F39B}\uFE0F Creating variables for ${e.packages.size} packages...`);for(let[i,c]of e.packages){if(!c)continue;let u=new W(`${i}_version`);r.set(i,u);let p=R(c);if(o.availableVersions.set(i,p),p.length>0){let l=y(p[0]),d=y(p[p.length-1]);if(l>0){let h=new E(u,k.Ge,l,$.required);n.addConstraint(h),s.push({type:"bounds",package:i,constraint:`>= ${x(l)}`,strength:"required"})}let f=new E(u,k.Le,d,$.required);n.addConstraint(f),s.push({type:"bounds",package:i,constraint:`<= ${x(d)}`,strength:"required"});let g=new E(u,k.Eq,d,$.weak);n.addConstraint(g),s.push({type:"preference",package:i,constraint:`prefer ${x(d)}`,strength:"weak"})}}console.log("Processing version constraints...");for(let[i,c]of e.constraints){if(!r.has(i))continue;let u=r.get(i);for(let p of c)try{let{constraint:l,requiredBy:d,type:f}=p,g=C(l),h=$.strong;if(f==="desired"?h=$.medium:f==="dependency"&&(h=$.strong),console.log(`\u{1F4CB} Adding constraint for ${i}: ${l} (${d}) -> range ${x(g.min)} - ${x(g.max)}`),g.min>0){let v=new E(u,k.Ge,g.min,h);n.addConstraint(v),s.push({type:"semver_min",package:i,constraint:`>= ${x(g.min)}`,requiredBy:d,strength:h.name,original:l}),console.log(`  \u2705 Added min constraint: ${i} >= ${x(g.min)}`)}if(g.max<Number.MAX_SAFE_INTEGER){let v=new E(u,k.Le,g.max,h);n.addConstraint(v),s.push({type:"semver_max",package:i,constraint:`<= ${x(g.max)}`,requiredBy:d,strength:h.name,original:l}),console.log(`  \u2705 Added max constraint: ${i} <= ${x(g.max)}`)}}catch(l){o.warnings.push({package:i,constraint:p.constraint,error:l.message,requiredBy:p.requiredBy})}}console.log("\u{1F504} Simulating package.json changes..."),console.log("Replacing package.json constraints with desired versions...");for(let[i,c]of t){let u;if(r.has(i))u=r.get(i);else{if(!e.packages.has(i)){o.conflicts.push({type:"missing_package",package:i,desiredVersion:c,message:`Package "${i}" not found in npm registry or project dependencies.`,requiredBy:[{package:"user request",type:"user",constraint:c}]});continue}let w=e.packages.get(i),I=R(w),m=y(I[0]),F=y(I[I.length-1]);u=new W(m,F),r.set(i,u),n.addVariable(u),console.log(`\u2795 Created variable for new package: ${i} (range: ${I[0]} - ${I[I.length-1]})`)}let p=e.packages.get(i),l=p?R(p):[],d=_e(c,l);if(d.error){o.conflicts.push({type:d.resolvedVersion===null?"version_not_exists":"invalid_semver_constraint",package:i,desiredVersion:c,message:d.error,details:{isConstraint:d.isConstraint,availableVersions:l.slice(-5)}});continue}let f=d.resolvedVersion,g=y(f);if(console.log(`\u{1F4E6} Processing user request: ${i}@${c}${d.isConstraint?` \u2192 resolved to ${f}`:""}`),!d.isConstraint&&p&&!l.includes(f)){o.conflicts.push({type:"version_not_exists",package:i,desiredVersion:f,message:`Version ${f} does not exist for ${i}. Available versions: ${l.slice(-5).join(", ")}`});continue}let h=e.constraints.get(i)||[],v=h.findIndex(w=>w.requiredBy==="root");if(v!==-1){let w=h[v].constraint;h[v]={...h[v],constraint:f,originalConstraint:w,isSimulated:!0};let I=d.isConstraint?`${c} \u2192 ${f}`:f;console.log(`\u{1F4DD} Simulating package.json change: ${i} "${w}" \u2192 "${I}"`),o.packageJsonChanges||(o.packageJsonChanges=new Map),o.packageJsonChanges.set(i,{from:w,to:d.isConstraint?`${c} \u2192 ${f}`:f,type:"change",wasConstraint:d.isConstraint,originalRequest:c})}else{let w=d.isConstraint?`${c} \u2192 ${f}`:f;console.log(`\u2795 Simulating package.json addition: ${i} + "${w}"`),o.packageJsonChanges||(o.packageJsonChanges=new Map),o.packageJsonChanges.set(i,{from:null,to:d.isConstraint?`${c} \u2192 ${f}`:f,type:"addition",wasConstraint:d.isConstraint,originalRequest:c})}let j=new E(u,k.Eq,g,$.required);try{n.addConstraint(j),h.push({type:"user_desired",package:i,constraint:f,requiredBy:"user",strength:"required",target:g,originalRequest:c})}catch(w){o.conflicts.push({type:"constraint_addition_failed",package:i,desiredVersion:c,message:`Cannot add constraint for ${i}@${c}: ${w.message}`})}}if(o.analysis.constraintsCount=s.length,o.conflicts.length>0)return console.log(`\u26A0\uFE0F Found ${o.conflicts.length} conflicts during setup. Skipping solver.`),o.solvable=!1,o.solution=new Map,o.warnings=[],o.analysis.processingTime=performance.now()-a,o;console.log("Solving constraint system...");try{n.updateVariables(),console.log("\u{1F4E4} Extracting solver solution:");for(let[i,c]of r){let u=c.value(),p=Math.round(u),l=x(p);console.log(`  ${i}: ${l} (${p})`),o.solution.set(i,{version:l,versionNumber:p,packageName:i})}o.solvable=!0,console.log("Validating solution..."),await _t(o,e),console.log("Checking constraint violations..."),qt(o,e)}catch(i){console.error("\u274C Constraint system cannot be solved:",i),o.solvable=!1,o.conflicts.push({type:"unsolvable_system",message:"The constraint system cannot be solved. This means your desired package versions are incompatible with existing dependencies.",details:i.message,suggestions:["Try updating fewer packages at once","Check if the desired versions are compatible with each other","Consider updating other dependencies first"]}),await Qe(o,e,t,r,n)}}catch(i){console.error("Constraint solving failed:",i),o.solvable=!1,o.conflicts.push({type:"solver_error",error:i.message,details:"Failed to solve the constraint system"}),await Qe(o,e,t,r,n)}return o.analysis.processingTime=performance.now()-a,o}async function _t(e,t){for(let[n,r]of e.solution){let s=t.packages.get(n);if(!s)continue;let a=R(s).map(c=>y(c)),i=r.versionNumber;if(!a.includes(i)){console.log(`\u{1F50D} ${n}: Solver wanted ${x(i)}, finding best available version...`);let u=(t.constraints.get(n)||[]).filter(g=>g.requiredBy!=="solver"),p=[];for(let g of a){let h=!0;for(let v of u)try{let{parseSemverConstraint:j}=await Promise.resolve().then(()=>(G(),Fe)),w=j(v.constraint);if(g<w.min||g>w.max){h=!1;break}}catch{h=!1;break}h&&p.push(g)}let l=null,d=!1;p.length>0?(l=Math.max(...p),console.log(`\u2705 ${n}: Found ${p.length} valid versions, picking highest: ${x(l)}`)):(l=a.reduce((g,h)=>Math.abs(h-i)<Math.abs(g-i)?h:g),d=!0,console.error(`\u274C ${n}: No available version satisfies constraints, nearest is ${x(l)}`));let f=x(l);d?(console.error(`\u274C UNSOLVABLE: ${n} solver wanted ${r.version} but no available version satisfies constraints`),e.solvable=!1,e.conflicts.push({type:"no_valid_version",package:n,message:"No available version satisfies all constraints",details:{solverOptimum:r.version,nearestAvailable:f,constraints:u.map(g=>`${g.constraint} (${g.requiredBy})`).join(", ")}}),console.log(`\u{1F6AB} NOT adjusting ${n} to ${f} because it violates constraints`)):(console.log(`\u2705 ${n}: Adjusted from solver optimum ${r.version} to valid available version ${f}`),r.version=f,r.versionNumber=l)}}}function qt(e,t){for(let[n,r]of e.solution){let s=t.constraints.get(n)||[],o=r.versionNumber,a=s.filter(l=>l.type!=="user_desired"&&l.requiredBy!=="user"),i=null,c=[],u=[];for(let l of a)try{let d=C(l.constraint);o>=d.min&&o<=d.max?c.push({constraint:l,range:d}):u.push({constraint:l,range:d})}catch{}let p=-1;for(let{constraint:l,range:d}of c)d.min>p&&(p=d.min,i=l);if(!i&&u.length>0){for(let[l,d]of t.packages.entries())if(l!==n&&d&&d.dependencies&&d.dependencies[n]){let f=d.dependencies[n];try{let g=C(f);o>=g.min&&o<=g.max&&g.min>p&&(i={constraint:f,requiredBy:l,type:"transitive"},p=g.min)}catch{continue}}}for(let l of s)if(!(l.type==="user_desired"||l.requiredBy==="user"))try{let d=C(l.constraint);(o<d.min||o>d.max)&&(console.error(`\u{1F6AB} Constraint violation: ${n}@${r.version} violates ${l.constraint} (required by ${l.requiredBy})`),e.conflicts.push({type:"constraint_violation",package:n,message:`Solution violates constraint: ${l.constraint} (required by ${l.requiredBy})`,details:{solvedVersion:r.version,solvedVersionNumber:o,constraint:l.constraint,requiredBy:l.requiredBy,allowedRange:`${x(d.min)} - ${x(d.max)}`,rangeMin:d.min,rangeMax:d.max,forcedBy:i?i.requiredBy:null,forcingConstraint:i?i.constraint:null}}),e.solvable=!1)}catch(d){console.warn(`\u26A0\uFE0F Failed to parse constraint ${l.constraint} for ${n}:`,d)}}e.solvable||console.error("\u274C Solution rejected due to constraint violations")}async function Qe(e,t,n,r,s){for(let[o,a]of n)try{let i=new Ce,c=new Map;for(let[u,p]of t.packages){if(!p)continue;let l=new W(`${u}_version`);c.set(u,l);let d=R(p);if(d.length>0){let f=y(d[0]),g=y(d[d.length-1]);i.addConstraint(new E(l,k.Ge,f,$.required)),i.addConstraint(new E(l,k.Le,g,$.required))}}for(let[u,p]of t.constraints){if(!c.has(u))continue;let l=c.get(u);for(let d of p){if(d.type==="desired"&&d.requiredBy==="user"&&u===o)continue;let f=C(d.constraint);f.min>0&&i.addConstraint(new E(l,k.Ge,f.min,$.strong)),f.max<Number.MAX_SAFE_INTEGER&&i.addConstraint(new E(l,k.Le,f.max,$.strong))}}i.updateVariables(),e.conflicts.push({type:"user_constraint_conflict",package:o,desiredVersion:a,message:`Desired version ${a} for ${o} conflicts with dependency constraints`})}catch{continue}for(let[o,a]of t.constraints){let i=n.has(o),c=a.map(u=>{try{return{...C(u.constraint),requiredBy:u.requiredBy,original:u.constraint,type:u.type}}catch(p){return console.warn(`Failed to parse constraint ${u.constraint} for ${o}:`,p),null}}).filter(u=>u!==null);for(let u=0;u<c.length;u++)for(let p=u+1;p<c.length;p++){let l=c[u],d=c[p];if(!(l.type==="user_desired"||d.type==="user_desired")&&(l.max<d.min||d.max<l.min)){let f=l.min>d.min?l:d,g=l.min>d.min?d:l;e.conflicts.push({type:"constraint_violation",package:o,message:`Solution violates constraint: ${l.original} (required by ${l.requiredBy})`,details:{solvedVersion:x((f.min+f.max)/2),solvedVersionNumber:(f.min+f.max)/2,constraint:l.original,requiredBy:l.requiredBy,allowedRange:`${x(l.min)} - ${x(l.max)}`,rangeMin:l.min,rangeMax:l.max,isTransitiveConflict:!0,forcedBy:f.requiredBy===l.requiredBy?null:f.requiredBy,forcingConstraint:f.requiredBy===l.requiredBy?null:f.original}}),e.conflicts.push({type:"constraint_violation",package:o,message:`Solution violates constraint: ${d.original} (required by ${d.requiredBy})`,details:{solvedVersion:x((f.min+f.max)/2),solvedVersionNumber:(f.min+f.max)/2,constraint:d.original,requiredBy:d.requiredBy,allowedRange:`${x(d.min)} - ${x(d.max)}`,rangeMin:d.min,rangeMax:d.max,isTransitiveConflict:!0,forcedBy:f.requiredBy===d.requiredBy?null:f.requiredBy,forcingConstraint:f.requiredBy===d.requiredBy?null:f.original}}),e.conflicts.push({type:"dependency_version_conflict",package:o,conflict:{constraint1:{constraint:l.original,requiredBy:l.requiredBy,range:`${x(l.min)} - ${x(l.max)}`},constraint2:{constraint:d.original,requiredBy:d.requiredBy,range:`${x(d.min)} - ${x(d.max)}`}},message:`Multiple dependencies require incompatible versions of ${o}`,isTransitiveConflict:!0})}}}}function Se(e,t){let n={summary:{compatible:e.solvable,totalPackages:e.analysis.totalPackages,constraintsCount:e.analysis.constraintsCount,processingTime:Math.round(e.analysis.processingTime),conflictsCount:e.conflicts.length,warningsCount:e.warnings.length},updates:[],conflicts:e.conflicts,warnings:e.warnings,packageJsonChanges:e.packageJsonChanges||null};for(let[r,s]of t){let o=e.solution.get(r),a=!1;if(o)try{let c=e.availableVersions&&e.availableVersions.get(r);c&&c.length>0?_e(s,c).resolvedVersion===o.version&&(a=!0):a=o.version===s}catch{a=o.version===s}let i={package:r,desired:s,possible:o?o.version:"N/A",compatible:a};!i.compatible&&o?i.reason=`Closest compatible version: ${o.version}`:o||(i.reason="Package not found or not analyzable"),n.updates.push(i)}return n}var Ee=D(()=>{We();G();de()});var et={};K(et,{buildDependencyGraph:()=>De,clearCache:()=>Vt,extractDependencyNames:()=>Ge,fetchMultiplePackages:()=>Mt,fetchPackageData:()=>Be,findVersionSatisfyingConstraint:()=>Ve,getAllVersions:()=>R,getDependenciesForVersion:()=>Ke,getLatestVersion:()=>pe});async function Be(e){if(H.has(e))return console.log(`\u{1F4F1} Using session cache for ${e}`),H.get(e);let t=await be(e);if(t)return H.set(e,t),t;await ue.acquire();try{if(H.has(e))return console.log(`\u{1F4F1} Using session cache for ${e} (acquired after wait)`),H.get(e);let n=performance.now();console.log(`\u{1F310} [START] Fetching ${e} (${ue.currentCount}/${ue.maxConcurrent} active)`);let r=await fetch(`${St}/${e}`),s=Math.round(performance.now()-n);if(console.log(`\u2705 [DONE] Fetched ${e} in ${s}ms`),!r.ok)throw r.status===404?new Error(`Package "${e}" not found`):new Error(`Failed to fetch package data: ${r.status}`);let o=await r.json();return H.set(e,o),await ye(e,o),o}catch(n){throw console.error(`\u274C Error fetching package data for ${e}:`,n),n}finally{ue.release()}}function Ke(e,t){let n=e.versions?.[t];return n?{...n.dependencies||{},...n.peerDependencies||{}}:{}}function pe(e){return e["dist-tags"]?.latest||""}function R(e){return e.versions?Object.keys(e.versions).filter(t=>!t.includes("-")||t.includes("beta")||t.includes("rc")).sort((t,n)=>{let r=t.split(".").map(o=>parseInt(o,10)),s=n.split(".").map(o=>parseInt(o,10));for(let o=0;o<Math.max(r.length,s.length);o++){let a=r[o]||0,i=s[o]||0;if(a!==i)return a-i}return 0}):[]}async function Mt(e,t=null){let n=new Map,r=0;console.log(`\u{1F680} Fetching ${e.length} packages (max ${Je} concurrent requests)`);let s=e.map(async o=>{try{let a=await Be(o);return n.set(o,a),r++,t&&t(r,e.length,o),a}catch(a){return console.error(`\u274C Failed to fetch ${o}:`,a),n.set(o,null),r++,t&&t(r,e.length,o,a),null}});return await Promise.all(s),console.log(`\u2705 Completed fetching ${e.length} packages`),n}function Ve(e,t,n=null){if(!t)return pe(e);try{let r=C(t),s=R(e),o=s.filter(i=>{let c=y(i);return c>=r.min&&c<=r.max});if(o.length===0)return console.warn(`\u26A0\uFE0F No versions satisfy constraint "${t}" for ${e.name||"unknown"}. Range: ${r.min} - ${r.max}. Available: ${s.slice(-5).join(", ")}`),null;let a=o[o.length-1];if(n&&n.size>0){let i=e.name;if((i==="react-dom"||i==="react-is"||i==="@types/react")&&n.has("react")){let c=n.get("react"),u=Ze(c);if(u!==null){let p=o.filter(l=>Ze(l)===u);p.length>0&&(a=p[p.length-1],console.log(`\u{1F3AF} Context-aware selection: chose ${i}@${a} to match React ${u}.x (user preference)`))}}}return console.log(`\u{1F3AF} Found version ${a} satisfying constraint "${t}" for ${e.name||"unknown"} (${o.length} options: ${o.slice(-3).join(", ")})`),a}catch(r){return console.warn(`\u26A0\uFE0F Invalid constraint "${t}", using latest version:`,r.message),pe(e)}}function Ze(e){if(!e)return null;let t=e.match(/(\d+)/);return t?parseInt(t[1]):null}function Ge(e,t=!1){let n=new Set,r=(s,o)=>{if(s&&typeof s=="object"){let a=Object.keys(s).length;a>0&&(console.log(`\u{1F4CB} Adding ${a} ${o} dependencies: ${Object.keys(s).slice(0,5).join(", ")}${a>5?"...":""}`),Object.keys(s).forEach(i=>n.add(i)))}};return r(e.dependencies,"runtime"),t?e.devDependencies&&Object.keys(e.devDependencies).length>0&&console.log(`\u{1F4CB} Skipping ${Object.keys(e.devDependencies).length} dev dependencies (excluded by user setting)`):r(e.devDependencies,"development"),r(e.peerDependencies,"peer"),r(e.optionalDependencies,"optional"),n}async function De(e,t=new Map,n=3,r=!1,s=null){console.log(`\u{1F3D7}\uFE0F Building dependency graph (max depth: ${n}, excludeDevDeps: ${r})`);let o={packages:new Map,constraints:new Map,conflicts:[]},a=new Set,i=new Set,c=Ge(e,r);console.log(`\u{1F4E6} Root dependencies: ${Array.from(c).join(", ")} ${r?"(dev deps excluded)":"(dev deps included)"}`);let u=[];for(let[d]of t)c.has(d)||(c.add(d),u.push(d));u.length>0&&console.log(`\u2795 Adding ${u.length} new packages from desired updates: ${u.join(", ")}`);let p=async(d,f)=>{if(f>=n||d.length===0)return[];if(console.log(`\u{1F504} Processing level ${f} with ${d.length} packages: ${d.map(m=>m.name).join(", ")}`),s){let m=15+f*15;s(`\u{1F504} Processing level ${f}`,m,o.packages.size,[...o.constraints.values()].flat().length)}let g=d.filter(m=>!a.has(m.name)&&!i.has(m.name));if(g.length===0)return[];g.forEach(m=>i.add(m.name)),console.log(`\u26A1 Starting ${g.length} parallel requests for level ${f}`);let h=performance.now(),v=g.map(async({name:m,requiredBy:F,constraint:re},Re)=>{try{!H.has(m)&&Re>0&&await new Promise(_=>setTimeout(_,Et*Re));let A=await Be(m);a.add(m),i.delete(m);let me=o.packages.get(m),lt=me&&me.selectedVersion;if(o.packages.set(m,A),o.constraints.has(m)||o.constraints.set(m,[]),F==="root"){let _=e.dependencies?.[m]||e.peerDependencies?.[m]||e.optionalDependencies?.[m];if(!r&&!_&&(_=e.devDependencies?.[m]),_){let X=e.dependencies?.[m]?"runtime":e.devDependencies?.[m]?"development":e.peerDependencies?.[m]?"peer":"optional";o.constraints.get(m).push({constraint:_,requiredBy:"root",type:"dependency",dependencyType:X}),console.log(`\u{1F4CB} Added package.json constraint for ${m}: ${_} (${X})`)}else t.has(m)&&console.log(`\u2795 New package ${m} - no package.json constraint, will rely on user desired version`)}else console.log(`\u{1F517} Processing transitive dependency: ${m} required by ${F}`);if(t.has(m)&&o.constraints.get(m).push({constraint:t.get(m),requiredBy:"user",type:"desired"}),f<n){let _=pe(A),X="latest";if(F==="root"){let M=!1;if(t.has(m)){let q=t.get(m);try{let V=R(A),{resolveSemverConstraint:ve}=await Promise.resolve().then(()=>(Ee(),Ye)),S=ve(q,V);if(S.resolvedVersion&&!S.error){_=S.resolvedVersion;let se=S.isConstraint?`${q} \u2192 ${S.resolvedVersion}`:S.resolvedVersion;X=`user desired (${se})`,M=!0,console.log(`\u{1F3AF} Using target version ${_} for ${m} dependencies (user upgrade: ${se})`)}else{console.warn(`\u26A0\uFE0F Failed to resolve desired version ${q} for ${m}: ${S.error||"unknown error"}`);let se=S.error&&S.error.includes("Invalid")&&(S.error.includes("caret")||S.error.includes("tilde")||S.error.includes("constraint")||S.error.includes("version"))?"invalid_semver_constraint":"version_resolution_error";o.conflicts.push({package:m,type:se,desiredVersion:q,error:S.error||"Unknown version resolution error",requiredBy:["user request"]})}}catch(V){console.warn(`\u26A0\uFE0F Failed to resolve desired version ${q} for ${m}, using package.json constraint:`,V.message);let ve=V.message&&V.message.includes("Invalid")&&(V.message.includes("caret")||V.message.includes("tilde")||V.message.includes("constraint")||V.message.includes("version"))?"invalid_semver_constraint":"version_resolution_error";o.conflicts.push({package:m,type:ve,desiredVersion:q,error:`Version parsing error: ${V.message}`,requiredBy:["user request"]})}}if(!M){let q=e.dependencies?.[m]||e.peerDependencies?.[m]||e.optionalDependencies?.[m];if(!r&&!q&&(q=e.devDependencies?.[m]),q){let V=Ve(A,q,t);if(V)_=V,X=`package.json (${q})`;else return console.warn(`\u26A0\uFE0F No version satisfies package.json constraint ${q} for ${m}, skipping dependency analysis`),[]}}}else if(re){let M=Ve(A,re,t);if(M)_=M,X=`${F} (${re})`;else return console.warn(`\u26A0\uFE0F No version satisfies constraint ${re} for ${m} (required by ${F}), skipping dependency analysis`),[]}if(console.log(`\u{1F527} Using version ${_} for ${m} dependencies (from ${X})`),lt)return console.log(`\u23ED\uFE0F  Skipping dependency processing for ${m} - already processed with version ${me.selectedVersion}`),[];A.selectedVersion=_,o.packages.set(m,A);let he=Ke(A,_);for(let[M,q]of Object.entries(he))o.constraints.has(M)||o.constraints.set(M,[]),o.constraints.get(M).push({constraint:q,requiredBy:m,type:"dependency"}),console.log(`\u{1F4CB} Added constraint: ${M} ${q} (required by ${m}@${_})`);return Object.keys(he).map(M=>({name:M,requiredBy:m,constraint:he[M]}))}return[]}catch(A){return i.delete(m),console.error(`\u274C Error processing package ${m}:`,A),o.conflicts.push({package:m,error:A.message,requiredBy:F}),[]}}),j=await Promise.all(v),w=Math.round(performance.now()-h);if(console.log(`\u23F1\uFE0F Level ${f} completed in ${w}ms (${g.length} packages processed in parallel)`),s){let m=20+f*15;s(`\u2705 Level ${f} completed`,Math.min(55,m),o.packages.size,[...o.constraints.values()].flat().length)}let I=j.flat();I.length>0&&await p(I,f+1)},l=Array.from(c).map(d=>({name:d,requiredBy:"root"}));return await p(l,0),console.log(`\u2705 Dependency graph built: ${o.packages.size} packages, ${o.constraints.size} constraints, ${o.conflicts.length} conflicts`),o}async function Vt(){H.clear();try{let{clearCache:e}=await Promise.resolve().then(()=>(ae(),Ne));await e(),console.log("\u{1F9F9} All caches cleared")}catch(e){console.error("\u274C Failed to clear IndexedDB cache:",e)}}var St,Je,Et,H,Me,ue,de=D(()=>{ae();G();St="https://registry.npmjs.org",Je=3,Et=100,H=new Map,Me=class{constructor(t=Je){this.maxConcurrent=t,this.currentCount=0,this.waitingQueue=[],console.log(`\u{1F6A6} RequestSemaphore initialized with max ${t} concurrent requests`)}async acquire(){return new Promise(t=>{console.log(`\u{1F512} Acquiring semaphore: ${this.currentCount}/${this.maxConcurrent} active, ${this.waitingQueue.length} waiting`),this.currentCount<this.maxConcurrent?(this.currentCount++,console.log(`\u2705 Semaphore acquired: ${this.currentCount}/${this.maxConcurrent} active`),t()):(console.log(`\u23F3 Semaphore full, adding to queue: ${this.waitingQueue.length+1} waiting`),this.waitingQueue.push(t))})}release(){if(console.log(`\u{1F513} Releasing semaphore: ${this.currentCount}/${this.maxConcurrent} active`),this.currentCount--,this.waitingQueue.length>0){let t=this.waitingQueue.shift();this.currentCount++,console.log(`\u{1F4CB} Processing next from queue: ${this.currentCount}/${this.maxConcurrent} active, ${this.waitingQueue.length} waiting`),t()}}},ue=new Me});var ot={};K(ot,{clearLogs:()=>At,getLogs:()=>zt,initUILogger:()=>Ae});function Ae(){Bt(),Dt(),console.log("\u{1F4DD} UI Logger initialized")}function Bt(){J=document.createElement("div"),J.id="ui-logs",J.innerHTML=`
        <div class="log-header">
            <span class="log-title" onclick="toggleLogs()" style="flex: 1; cursor: pointer;">\u{1F4DD} Browser Logs (<span id="log-count">0</span>)</span>
            <div class="log-controls">
                <button class="log-copy-btn" onclick="copyLogs(event)" title="Copy all logs to clipboard">\u{1F4CB}</button>
                <span class="log-toggle" id="log-toggle" onclick="toggleLogs()" style="cursor: pointer;">\u25B2</span>
            </div>
        </div>
        <div class="log-content" id="log-content"></div>
    `;let e=document.createElement("style");e.textContent=`
        #ui-logs {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #1e1e1e;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            z-index: 9999;
            border-top: 1px solid #333;
            max-height: 40vh;
            transition: all 0.3s ease;
        }
        
        .log-header {
            background: #2d2d2d;
            padding: 8px 15px;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
        }
        
        .log-title {
            font-weight: bold;
        }
        
        .log-title:hover {
            background: #333;
            border-radius: 3px;
            padding: 2px 4px;
            margin: -2px -4px;
        }
        
        .log-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .log-copy-btn {
            background: #4a4a4a;
            border: none;
            color: #fff;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }
        
        .log-copy-btn:hover {
            background: #5a5a5a;
        }
        
        .log-copy-btn:active {
            background: #3a3a3a;
        }
        
        .log-toggle {
            transition: transform 0.2s ease;
            padding: 2px;
        }
        
        .log-toggle:hover {
            background: #4a4a4a;
            border-radius: 3px;
        }
        
        .log-content {
            max-height: 300px;
            overflow-y: auto;
            padding: 0;
        }
        
        .log-entry {
            padding: 4px 15px;
            border-bottom: 1px solid #333;
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }
        
        .log-timestamp {
            color: #888;
            min-width: 70px;
            font-size: 10px;
        }
        
        .log-level {
            min-width: 45px;
            font-weight: bold;
        }
        
        .log-level.info { color: #4da6ff; }
        .log-level.warn { color: #ffb84d; }
        .log-level.error { color: #ff6b6b; }
        .log-level.debug { color: #888; }
        
        .log-message {
            flex: 1;
            word-break: break-all;
        }
        
        .log-collapsed {
            transform: translateY(calc(100% - 35px));
        }
        
        .log-collapsed .log-toggle {
            transform: rotate(180deg);
        }
        
        .log-collapsed .log-content {
            display: none;
        }
        
        /* Scrollbar styling */
        .log-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .log-content::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        
        .log-content::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 3px;
        }
        
        .log-content::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
    `,document.head.appendChild(e),document.body.appendChild(J),window.toggleLogs=tt,window.copyLogs=jt,tt()}function tt(){Ie=!Ie;let e=document.getElementById("log-toggle");Ie?(J.classList.add("log-collapsed"),e.textContent="\u25BC"):(J.classList.remove("log-collapsed"),e.textContent="\u25B2")}function Dt(){let e={log:console.log,warn:console.warn,error:console.error,info:console.info,debug:console.debug};console.log=(...t)=>{e.log(...t),te("info",t)},console.warn=(...t)=>{e.warn(...t),te("warn",t)},console.error=(...t)=>{e.error(...t),te("error",t)},console.info=(...t)=>{e.info(...t),te("info",t)},console.debug=(...t)=>{e.debug(...t),te("debug",t)}}function te(e,t){let n=new Date().toLocaleTimeString(),r=t.map(o=>typeof o=="object"?JSON.stringify(o,null,2):String(o)).join(" "),s={timestamp:n,level:e,message:r};T.push(s),T.length>100&&T.shift(),nt()}function nt(){let e=document.getElementById("log-content"),t=document.getElementById("log-count");!e||!t||(t.textContent=T.length,e.innerHTML=T.map(n=>`
        <div class="log-entry">
            <span class="log-timestamp">${n.timestamp}</span>
            <span class="log-level ${n.level}">${n.level.toUpperCase()}</span>
            <span class="log-message">${It(n.message)}</span>
        </div>
    `).join(""),e.scrollTop=e.scrollHeight)}function It(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function At(){T.length=0,nt(),console.log("\u{1F9F9} UI logs cleared")}function zt(){return[...T]}async function jt(e){if(e.stopPropagation(),T.length===0){console.warn("No logs to copy");return}let t=T.map(n=>`[${n.timestamp}] ${n.level.toUpperCase()}: ${n.message}`).join(`
`);try{await navigator.clipboard.writeText(t);let n=e.target,r=n.textContent;n.textContent="\u2713",n.style.background="#10b981",setTimeout(()=>{n.textContent=r,n.style.background="#4a4a4a"},1e3),console.log(`\u{1F4CB} Copied ${T.length} log entries to clipboard`)}catch(n){console.error("Failed to copy logs:",n),console.log(`=== LOGS ===
`+t+`
=== END LOGS ===`)}}var T,J,Ie,ze=D(()=>{T=[],J=null,Ie=!1});de();Ee();G();ze();ae();var N=null,Tt=null,Pt=document.getElementById("packageFile"),at=document.getElementById("packageContent"),ge=document.getElementById("packagesList"),ct=document.getElementById("loading"),Q=document.getElementById("results"),oe=document.getElementById("resultsTitle"),Te=document.getElementById("resultsContent"),ne=document.getElementById("dependencyTree");Pt.addEventListener("change",Ft);at.addEventListener("input",Ut);async function Rt(){try{let{clearCache:e}=await Promise.resolve().then(()=>(de(),et));await e();let{clearLogs:t}=await Promise.resolve().then(()=>(ze(),ot));t(),an("\u{1F9F9} All caches and logs cleared successfully!")}catch(e){console.error("\u274C Failed to clear caches:",e),fe("Failed to clear caches: "+e.message)}}function Lt(){let e=document.getElementById("excludeDevDeps");return e?e.checked:!0}function Nt(){let e=document.getElementById("packageExamples"),t=document.getElementById("packageContent");if(!e||!t)return;let n={"basic-react":{dependencies:{react:"^17.0.2","react-dom":"^17.0.2"}},"react-mui":{dependencies:{react:"^17.0.2","react-dom":"^17.0.2","@mui/material":"^5.4.0"}}},r=e.value;if(r&&n[r]){let s=JSON.stringify(n[r],null,2);t.value=s,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0})),t.style.background="#f0fdf4",t.style.borderColor="#10b981",setTimeout(()=>{t.style.background="",t.style.borderColor=""},1e3),console.log(`\u{1F4C4} Loaded ${r} example`)}}async function Ft(e){let t=e.target.files[0];if(t)try{let n=await t.text();at.value=n,N=JSON.parse(n),console.log("Loaded package.json:",N.name||"Unknown project")}catch(n){fe("Invalid package.json file: "+n.message),N=null}}function Ut(e){let t=e.target.value.trim();if(!t){N=null;return}try{N=JSON.parse(t),console.log("Parsed package.json:",N.name||"Unknown project")}catch{N=null}}function Pe(){let e=document.createElement("div");e.className="package-item",e.innerHTML=`
        <input type="text" placeholder="Package name (e.g., react)" />
        <input type="text" placeholder="Desired version (e.g., 19.1.2)" />
        <button onclick="removePackageItem(this)">Remove</button>
    `,ge.appendChild(e)}function Ot(e){e.parentElement.remove(),ge.children.length===0&&Pe()}function Ht(){let e=new Map,t=ge.querySelectorAll(".package-item");for(let n of t){let r=n.querySelectorAll('input[type="text"]'),s=r[0].value.trim(),o=r[1].value.trim();s&&o&&e.set(s,o)}return e}async function Xt(){if(!N){fe("Please provide a valid package.json file");return}let e=Ht();st(!0),sn(),rn(),window.analysisStartTime=Date.now();try{e.size===0?console.log("\u{1F50D} Starting package.json analysis (no desired updates)..."):(console.log("\u{1F504} Starting compatibility analysis..."),console.log("Desired updates:",Array.from(e.entries()))),je("Building dependency graph..."),L("\u{1F3D7}\uFE0F Building dependency graph...",10,0,0,0);let t=Lt();console.log(`\u{1F4CB} Processing dependencies (excludeDevDeps: ${t})`);let r=await De(N,e,2,t,(i,c,u,p)=>{let l=Date.now()-(window.analysisStartTime||Date.now());L(i,c,u,p,l)});console.log("Dependency graph built:",{packages:r.packages.size,constraints:r.constraints.size,conflicts:r.conflicts.length}),L("\u2705 Dependency graph completed",60,r.packages.size,r.constraints.size,Date.now()-(window.analysisStartTime||Date.now())),je("Solving version constraints..."),L("\u{1F9EE} Solving version constraints...",70,r.packages.size,r.constraints.size,Date.now()-(window.analysisStartTime||Date.now()));let s=await qe(r,e);console.log("Constraint solving completed:",{solvable:s.solvable,solutions:s.solution.size,conflicts:s.conflicts.length,warnings:s.warnings.length}),L("\u{1F9EE} Constraints solved",85,r.packages.size,r.constraints.size,Date.now()-(window.analysisStartTime||Date.now())),je("Generating compatibility report..."),L("\u{1F4CA} Generating report...",95,r.packages.size,r.constraints.size,Date.now()-(window.analysisStartTime||Date.now()));let o=Se(s,e),a=await xe();o.cacheStats=a,Tt={dependencyGraph:r,solutionResult:s,report:o,desiredUpdates:e},L("\u{1F389} Analysis completed!",100,r.packages.size,r.constraints.size,Date.now()-(window.analysisStartTime||Date.now())),Wt(o,r)}catch(t){console.error("Analysis failed:",t),L("\u274C Analysis failed",0,0,0,Date.now()-(window.analysisStartTime||Date.now())),fe("Analysis failed: "+t.message)}finally{st(!1)}}function Wt(e,t){let{summary:n,updates:r,conflicts:s,warnings:o}=e,a=r.length>0;n.compatible?oe.textContent=a?"\u2705 Updates are compatible!":"\u2705 Package.json is healthy!":s.length>0?oe.textContent=a?"\u274C Conflicts found":"\u274C Package.json has conflicts":oe.textContent=a?"\u26A0\uFE0F Issues found":"\u26A0\uFE0F Package.json has issues",Q.className="results "+(n.compatible?"success":"error");let i=`
        <div style="margin-bottom: 20px;">
            <span style="font-size: 14px; color: #64748b; line-height: 1.5; vertical-align: middle; display: inline-flex; align-items: center;">
                \u{1F4E6} ${n.totalPackages} packages \u2022 \u{1F517} ${n.constraintsCount} constraints \u2022 \u23F1\uFE0F ${n.processingTime}ms \u2022 \u{1F6AB} ${n.conflictsCount} conflicts \u2022 \u26A0\uFE0F ${n.warningsCount} warnings
            </span>
        </div>
    `;if(e.packageJsonChanges&&e.packageJsonChanges.size>0){i+=`
            <div style="margin-bottom: 20px; padding: 16px; background: #fefce8; border: 1px solid #facc15; border-radius: 8px;">
                <h4 style="margin: 0 0 12px 0; color: #ca8a04;">\u{1F4DD} Simulated package.json Changes</h4>
                <div style="margin-bottom: 12px; font-size: 14px; color: #a16207;">
                    The analysis simulated these changes to your package.json:
                </div>
        `;for(let[c,u]of e.packageJsonChanges){let p=u.type==="addition";i+=`
                <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 6px; border-left: 3px solid ${p?"#10b981":"#f59e0b"};">
                    <div style="font-weight: bold; margin-bottom: 4px; color: #1f2937;">
                        ${p?"\u2795":"\u{1F4DD}"} ${c}:
                    </div>
                    <div style="font-family: 'Monaco', 'Menlo', monospace; font-size: 12px;">
                        ${p?"":`<div style="color: #dc2626; margin-bottom: 2px;">- "${u.from}"</div>`}
                        <div style="color: #059669;">+ "${u.to}"</div>
                    </div>
                </div>
            `}i+=`
                <div style="margin-top: 12px; padding: 8px; background: #fef3c7; border-radius: 4px; font-size: 12px; color: #92400e;">
                    <strong>\u{1F4A1} Note:</strong> This is a simulation showing what would happen if you changed your package.json. You would need to manually update the file.
                </div>
            </div>
        `}if(e.cacheStats&&(i+=`
            <div style="margin-bottom: 20px;">
                <span style="font-size: 14px; color: #64748b; line-height: 1.5; vertical-align: middle; display: inline-flex; align-items: center;">
                    \u{1F4BE} ${e.cacheStats.entries} cached \u2022 \u23F0 ${Math.round(e.cacheStats.cacheDuration/1e3/60/60)}h duration \u2022 \u{1F5C4}\uFE0F ${e.cacheStats.dbName||"IndexedDB"}
                </span>
            </div>
        `),s.length>0){i+=`
            <div style="margin-bottom: 20px;">
                <h4>\u274C Why Updates Failed</h4>
                <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; padding: 15px;">
        `;let c=Qt(s);for(let[u,p]of c){let l=p.filter(h=>h.type==="constraint_violation"),d=l.length>1,f=p[0],g=f.desiredVersion?`@${f.desiredVersion}`:"";if(i+=`
                                        <div style="margin-bottom: 15px; padding: 12px; background: white; border-left: 4px solid #ef4444; border-radius: 4px;">
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #dc2626;">${u}${g}</strong>
                        ${d?`<span style="background: #fecaca; color: #991b1b; padding: 2px 6px; border-radius: 10px; font-size: 11px; margin-left: 8px;">\u26A0\uFE0F ${l.length} conflicts</span>`:""}
                    </div>

            `,d){i+=`
                    <div style="margin-top: 12px; padding: 12px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px;">
                        <div style="font-weight: bold; color: #dc2626; margin-bottom: 8px;">\u{1F6AB} Multiple Constraint Violations:</div>
                        <div style="font-family: monospace; font-size: 12px; line-height: 1.4; margin-bottom: 8px;">
                            <div><strong>Solved version:</strong> <span style="color: #dc2626;">${l[0].details.solvedVersion}</span></div>
                        </div>
                `;for(let[h,v]of l.entries())i+=`
                            <div style="margin-bottom: 6px; padding: 6px; background: #fee; border-radius: 3px;">
                                <div style="font-size: 12px; line-height: 1.3;">
                                    <strong style="color: #dc2626;">Conflict #${h+1}:</strong> 
                                    <code style="background: #fecaca; padding: 1px 3px; border-radius: 2px;" title="Allowed range: ${v.details.allowedRange}">${v.details.constraint}</code>
                                    <span style="color: #7c3aed; margin-left: 4px; font-size: 11px;">\u2190 required by ${v.details.requiredBy}</span>
                                    ${v.details.forcedBy?`
                                        <div style="margin-top: 3px; font-size: 11px; color: #dc2626;">
                                            <strong>Forced by:</strong> <code style="background: #fecaca; padding: 1px 2px; border-radius: 2px;">${v.details.forcingConstraint}</code> 
                                            <span style="color: #7c3aed;">\u2190 ${v.details.forcedBy}</span>
                                        </div>
                                    `:""}
                                </div>
                            </div>
                        `;i+=`
                        <div style="margin-top: 8px; padding: 6px; background: #fee; border-radius: 3px; font-size: 11px; color: #7f1d1d;">
                            <strong>\u26A0\uFE0F Critical Error:</strong> No version can satisfy all constraints simultaneously!
                        </div>
                    </div>
                `}else{let h=f;if(h.requiredBy&&h.requiredBy.length>0&&(i+=rt(h.requiredBy)),h.suggestions&&h.suggestions.length>0){i+=`
                        <div style="margin-top: 8px; padding: 8px; background: #f0f9ff; border-radius: 4px; font-size: 14px; color: #0369a1;">
                            <strong>\u{1F4A1} Suggestions:</strong>
                            <ul style="margin: 4px 0; padding-left: 20px;">
                    `;for(let v of h.suggestions)i+=`<li>${v}</li>`;i+="</ul></div>"}if(h.type==="constraint_violation"&&h.details){let v=Yt(h,t);i+=`
                        <div style="margin-top: 8px; padding: 12px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px;">
                            <div style="font-weight: bold; color: #dc2626; margin-bottom: 8px;">\u{1F6AB} Dependency Conflict:</div>
                            ${v}

                            <div style="margin-top: 8px; padding: 6px; background: #fee; border-radius: 3px; font-size: 11px; color: #7f1d1d;">
                                <strong>\u{1F4A1} Solution:</strong> Update to a compatible version or remove/update the conflicting dependency.
                            </div>
                        </div>
                    `}else if(h.type==="version_resolution_error")i+=`
                        <div style="margin-top: 8px; padding: 12px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px;">
                            <div style="font-weight: bold; color: #dc2626; margin-bottom: 8px;">\u{1F6AB} Invalid Version Request:</div>
                            <div style="font-size: 13px; color: #374151; line-height: 1.4; margin-bottom: 8px;">
                                ${h.error}
                            </div>
                            <div style="margin-top: 8px; padding: 6px; background: #fee; border-radius: 3px; font-size: 11px; color: #7f1d1d;">
                                <strong>\u{1F4A1} Solution:</strong> Choose a valid version that exists for this package.
                            </div>
                        </div>
                    `;else if(h.type==="no_valid_version"){let v=Zt(h,t);i+=`
                        <div style="margin-top: 8px; padding: 12px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px;">
                            <div style="font-weight: bold; color: #dc2626; margin-bottom: 8px;">\u{1F6AB} Dependency Conflict:</div>
                            ${v}

                            <div style="margin-top: 8px; padding: 6px; background: #fee; border-radius: 3px; font-size: 11px; color: #7f1d1d;">
                                <strong>\u{1F4A1} Solution:</strong> Update to a compatible version or remove/update the conflicting dependency.
                            </div>
                        </div>
                    `}else h.conflict&&(i+=`
                        <details style="margin-top: 8px; font-size: 13px; color: #6b7280;">
                            <summary style="cursor: pointer; font-weight: bold;">\u{1F50D} Technical details</summary>
                            <div style="margin-top: 8px; padding: 8px; background: #f9fafb; border-radius: 3px; font-family: monospace; font-size: 12px;">
                                <div>\u{1F4E6} ${h.conflict.constraint1.requiredBy} requires: <code style="color: #dc2626;">${h.conflict.constraint1.constraint}</code></div>
                                <div>\u{1F4E6} ${h.conflict.constraint2.requiredBy} requires: <code style="color: #dc2626;">${h.conflict.constraint2.constraint}</code></div>
                                <div style="margin-top: 4px; color: #7f1d1d; font-weight: bold;">\u26A0\uFE0F These constraints cannot be satisfied simultaneously</div>
                            </div>
                        </details>
                    `)}i+="</div>"}i+="</div></div>"}if(o.length>0){i+=`
            <div style="margin-bottom: 20px;">
                <h4>\u26A0\uFE0F Warnings</h4>
                <div style="background: #fffbeb; border: 1px solid #fbbf24; border-radius: 6px; padding: 15px;">
        `;for(let c of o){let u=c.message||c.error,p="";if(c.type==="version_adjustment"&&c.actualVersion){if(u=`Adjusted to nearest available version: <strong>${c.actualVersion}</strong>`,c.solvedVersion){let l=c.requiredBy||[],d=[...new Set(l.map(f=>f.constraint))].filter(Boolean);if(d.length>0){let f=[...new Set(d)];u+=` <span style="color: #6b7280;">(from constraints: ${f.join(", ")} \u2192 solver optimum: ${c.solvedVersion})</span>`}else u+=` <span style="color: #6b7280;">(solver optimum: ${c.solvedVersion})</span>`}c.requiredBy&&c.requiredBy.length>0&&(p=rt(c.requiredBy))}i+=`
                <div style="margin-bottom: 12px; padding: 12px; background: white; border-left: 3px solid #fbbf24; border-radius: 4px;">
                    <div style="margin-bottom: 8px;">
                        <strong style="color: #92400e;">${c.package}:</strong> ${u}
                    </div>
                    ${p}
                </div>
            `}i+="</div></div>"}t&&n.compatible&&(i+=`
            <button type="button" onclick="toggleDependencyTree()" style="margin-top: 15px; padding: 10px 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 8px rgba(102, 126, 234, 0.4)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(102, 126, 234, 0.3)';">
                \u{1F4CA} Show Dependency Tree
            </button>
        `,on(t)),Te.innerHTML=i,Q.style.display="block"}function Qt(e){let t=new Map;for(let n of e){let r=n.package||"System";t.has(r)||t.set(r,[]),t.get(r).push(n)}return t}function rt(e){if(!e||e.length===0)return"";let t=`
        <div style="margin-top: 8px; padding: 8px; background: #f9fafb; border-radius: 4px; font-size: 13px;">
            <div style="font-weight: bold; color: #374151; margin-bottom: 6px;">\u{1F4CB} Required by:</div>
    `;for(let n of e)if(n.type==="root")t+=`
                <div style="margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                    <span style="color: #059669;">\u{1F4E6}</span>
                    <span style="font-weight: bold;">package.json</span>
                    <span style="color: #6b7280;">(<code>${n.constraint}</code>)</span>
                </div>
            `;else if(n.type==="user")t+=`
                <div style="margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                    <span style="color: #7c3aed;">\u{1F464}</span>
                    <span style="font-weight: bold;">user request</span>
                    <span style="color: #6b7280;">(<code>${n.constraint}</code>)</span>
                </div>
            `;else if(n.type==="transitive"&&n.chain){t+=`
                <div style="margin-bottom: 4px;">
                    <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 2px;">
                        <span style="color: #f59e0b;">\u{1F517}</span>
                        <span style="font-weight: bold;">${n.package}</span>
                        <span style="color: #6b7280;">(<code>${n.constraint}</code>)</span>
                    </div>
            `;for(let r of n.chain)if(r&&r.length>0){let s=r.reverse().join(" \u2192 ");t+=`
                        <div style="margin-left: 20px; color: #6b7280; font-size: 12px;">
                            \u{1F4CD} ${s}
                        </div>
                    `}t+="</div>"}return t+="</div>",t}function Yt(e,t){let n=e.package,r=e.details.requiredBy,s=`
        <div style="margin-bottom: 12px; padding: 10px; background: white; border-radius: 4px; border-left: 4px solid #dc2626;">
            <div style="font-family: 'Monaco', 'Menlo', monospace; font-size: 13px; line-height: 1.6; color: #374151;">
                <div style="font-weight: bold; margin-bottom: 8px; color: #dc2626;">\u{1F4E6} Dependency Tree (like \`npm ls\`):</div>
    `;s+=`
        <div style="margin-bottom: 2px;">
            <span style="color: #059669;">\u{1F4C4}</span> <strong>package.json</strong>
        </div>
    `;let o=null;if(e.details.forcedBy&&e.details.forcingConstraint?o=Gt(n,e,t):o=Jt(n,r,t),o&&o.length>0){for(let a=0;a<o.length;a++){let i=o[a],c=a===o.length-1,u=c?"\u2514\u2500\u2500":"\u251C\u2500\u2500",p="\u2502   ".repeat(a)+u,l="\u{1F4E6}",d="#6b7280";if(i.isConflicting?(l="\u{1F6AB}",d="#dc2626"):i.isRequesting&&(l="\u{1F464}",d="#7c3aed"),s+=`
                <div style="margin-bottom: 3px; color: ${d}; font-size: 13px;">
                    <span style="color: #9ca3af; margin-right: 4px;">${p}</span>
                    <span>${l}</span>
                    <strong style="margin-left: 4px;">${i.package}</strong><span style="color: #6b7280;">@</span><code style="background: #f3f4f6; padding: 1px 3px; border-radius: 2px; font-size: 12px;">${i.version}</code>
                    ${i.constraint?`<span style="color: #6b7280; font-size: 11px; margin-left: 8px;">(needs ${i.constraint})</span>`:""}
                </div>
            `,i.isConflicting&&c){let f="\u2502   ".repeat(a+1)+"\u2514\u2500\u2500";s+=`
                    <div style="margin-bottom: 3px; color: #dc2626; font-size: 12px; font-style: italic;">
                        <span style="color: #9ca3af; margin-right: 4px;">${f}</span>
                        \u274C <strong>requires ${n}@${e.details.constraint}</strong>
                    </div>
                `}}if(o.length>0)if(e.details.forcedBy&&e.details.forcingConstraint)s+=`
                    <div style="margin-top: 8px; padding: 8px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px; font-size: 12px;">
                        <div style="color: #dc2626; font-weight: bold; margin-bottom: 4px;">\u26A0\uFE0F Conflict Details:</div>
                        <div style="color: #7f1d1d; line-height: 1.4;">
                            \u2022 <strong>${e.details.requiredBy}</strong> wants: ${n}@${e.details.constraint}
                            <br>\u2022 <strong>${e.details.forcedBy}</strong> forces: ${n}@${e.details.forcingConstraint}
                            <br>\u2022 <strong>Solver picked:</strong> ${e.details.solvedVersion} (violates ${e.details.requiredBy}'s constraint)
                        </div>
                    </div>
                `;else{let a=tn(n,e,t);a.length>1?(s+=`
                        <div style="margin-top: 8px; padding: 6px; background: #fef2f2; border-radius: 3px; font-size: 12px;">
                            <span style="color: #dc2626;">\u26A0\uFE0F <strong>Multiple requirements conflict:</strong></span>
                            <div style="margin-top: 4px;">
                    `,a.forEach(i=>{s+=`
                            <div style="font-size: 11px; color: #7f1d1d; margin-left: 8px;">
                                \u2022 <strong>${i.requiredBy}</strong> needs ${n}@${i.constraint}
                            </div>
                        `}),s+=`
                            </div>
                        </div>
                    `):s+=`
                        <div style="margin-top: 8px; padding: 6px; background: #fef2f2; border-radius: 3px; font-size: 12px;">
                            <span style="color: #dc2626;">\u26A0\uFE0F <strong>Constraint system resolved to:</strong></span> ${n}@${e.details.solvedVersion}
                        </div>
                    `}}else s+=`
            <div style="margin-left: 20px; color: #dc2626;">
                \u2514\u2500\u2500 <span style="color: #dc2626;">\u{1F6AB}</span> <strong>Conflict:</strong> ${n}@${e.details.constraint} (required by ${r})
            </div>
        `,console.log(`\u{1F50D} Fallback section - checking forcing info: forcedBy="${e.details.forcedBy}", forcingConstraint="${e.details.forcingConstraint}"`),e.details.forcedBy&&e.details.forcingConstraint?(console.log("\u2705 Adding detailed conflict explanation in fallback"),s+=`
                <div style="margin-top: 8px; padding: 8px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px; font-size: 12px;">
                    <div style="color: #dc2626; font-weight: bold; margin-bottom: 4px;">\u26A0\uFE0F Conflict Details:</div>
                    <div style="color: #7f1d1d; line-height: 1.4;">
                        \u2022 <strong>${e.details.requiredBy}</strong> wants: ${n}@${e.details.constraint}
                        <br>\u2022 <strong>${e.details.forcedBy}</strong> forces: ${n}@${e.details.forcingConstraint}
                        <br>\u2022 <strong>Solver picked:</strong> ${e.details.solvedVersion} (violates ${e.details.requiredBy}'s constraint)
                    </div>
                </div>
            `):console.log("\u274C No detailed conflict explanation added - missing forcing info");return s+=`
            </div>
        </div>
    `,s}function Zt(e,t){let n=e.package,r=e.details.constraints.split("), "),s=[];r.forEach((a,i)=>{let c=a.match(/^(.+?)\s+\((.+?)(\)|$)/);if(c){let u=c[1].trim(),p=c[2].trim();s.push({constraint:u,requiredBy:p})}});let o=`
        <div style="margin-bottom: 12px; padding: 10px; background: white; border-radius: 4px; border-left: 4px solid #dc2626;">
            <div style="font-family: 'Monaco', 'Menlo', monospace; font-size: 13px; line-height: 1.6; color: #374151;">
                <div style="font-weight: bold; margin-bottom: 8px; color: #dc2626;">\u{1F4E6} Dependency Tree (like \`npm ls\`):</div>
    `;if(o+=`
        <div style="margin-bottom: 2px;">
            <span style="color: #059669;">\u{1F4C4}</span> <strong>package.json</strong>
        </div>
    `,s.length>0){let a=s[0];o+=`
            <div style="margin-bottom: 3px; color: #6b7280; font-size: 13px;">
                <span style="color: #9ca3af; margin-right: 4px;">\u251C\u2500\u2500</span>
                <span>\u{1F4E6}</span>
                <strong style="margin-left: 4px;">${a.requiredBy}</strong>
                <span style="color: #6b7280; font-size: 11px; margin-left: 8px;">(needs ${n}@${a.constraint})</span>
            </div>
            <div style="margin-bottom: 3px; color: #dc2626; font-size: 12px;">
                <span style="color: #9ca3af; margin-right: 4px;">\u2502   \u2514\u2500\u2500</span>
                \u274C <strong>requires ${n}@${a.constraint}</strong>
            </div>
        `}return s.length>1&&(o+=`
            <div style="margin-top: 8px; padding: 6px; background: #fef2f2; border-radius: 3px; font-size: 12px;">
                <span style="color: #dc2626;">\u26A0\uFE0F <strong>Other dependencies also need ${n}:</strong></span>
                <div style="margin-top: 4px;">
        `,s.slice(1).forEach(a=>{o+=`
                <div style="font-size: 11px; color: #7f1d1d; margin-left: 8px;">
                    \u2022 <strong>${a.requiredBy}</strong> needs ${n}@${a.constraint}
                </div>
            `}),o+=`
                </div>
            </div>
        `),o+=`
            </div>
        </div>
    `,o}function Jt(e,t,n){console.log(`\u{1F50D} Tracing dependency path: ${e} \u2190 ${t}`);let r=[],s=en(e,t,n);for(let o=0;o<s.length;o++){let a=s[o],i=s[o+1],c=null;if(i){let p=(n.constraints.get(i.package)||[]).find(l=>l.requiredBy===a.package);p&&(c=`${i.package}@${p.constraint}`)}else if(o===s.length-1){let p=(n.constraints.get(e)||[]).find(l=>l.requiredBy===a.package);p&&(c=`${e}@${p.constraint}`)}r.push({package:a.package,version:a.version,constraint:c,isConflicting:a.package===t,isRequesting:!1,requiredBy:a.requiredBy})}return console.log(`\u{1F3AF} Built dependency path with ${r.length} steps:`,r.map(o=>`${o.package}@${o.version}`).join(" \u2192 ")),r}function Kt(e,t,n){let r=new Set,s=[{package:e,path:[]}];for(;s.length>0;){let{package:o,path:a}=s.shift();if(r.has(o))continue;if(r.add(o),o===t)return a;let i=n.packages.get(o);if(i?.selectedVersion){let u=n.constraints.get(o)||[];for(let p of u)if(p.requiredBy===o){let l=p.package;if(!r.has(l)){let d=[...a,{package:o,version:i.selectedVersion,constraint:`${l}@${p.constraint}`,isConflicting:!1,isRequesting:!1,requiredBy:a.length>0?a[a.length-1].package:"root"}];s.push({package:l,path:d})}}}let c=[...n.constraints.values()].flat();for(let u of c)if(u.requiredBy===o&&!r.has(u.package)){let p=[...a,{package:o,version:i?.selectedVersion||"latest",constraint:`${u.package}@${u.constraint}`,isConflicting:!1,isRequesting:!1,requiredBy:a.length>0?a[a.length-1].package:"root"}];s.push({package:u.package,path:p})}}return null}function Gt(e,t,n){let r=[],s=t.details.forcedBy,o=t.details.forcingConstraint,a=t.details.requiredBy;if(console.log(`\u{1F50D} Building conflict path using forcing info: ${e} forced by ${s} with ${o}`),a==="root"){let i=n.packages.get(s);i&&(r.push({package:s,version:i.version||"latest",constraint:null,isConflicting:!1,isRequesting:!1,requiredBy:"root"}),r.push({package:e,version:t.details.solvedVersion,constraint:`${e}@${o}`,isConflicting:!0,isRequesting:!1,requiredBy:s}))}else if(s&&s!==a){if((n.constraints.get(a)||[]).find(l=>l.requiredBy==="root")){let l=n.packages.get(a);r.push({package:a,version:l?.version||"latest",constraint:null,isConflicting:!1,isRequesting:!1,requiredBy:"root"})}let u=Kt(a,s,n);u&&u.length>0&&r.push(...u);let p=n.packages.get(s);p&&!r.some(l=>l.package===s)&&r.push({package:s,version:p.version||"latest",constraint:`${e}@${o}`,isConflicting:!0,isRequesting:!1,requiredBy:u&&u.length>0?u[u.length-1].package:a})}return console.log(`\u{1F3AF} Built forcing conflict path with ${r.length} steps:`,r.map(i=>`${i.package}@${i.version}`).join(" \u2192 ")),r.length>0?r:null}function en(e,t,n){let r=[],s=new Set,o=t;for(;o&&o!=="root"&&o!=="user"&&!s.has(o);){s.add(o);let a=n.constraints.get(o)||[],i=null;if(i=a.find(c=>c.requiredBy==="root")||a.find(c=>c.requiredBy!==o)||a[0],i){let c=n.packages.get(o),u=nn(i.constraint);c&&c.version&&(u=c.version),r.unshift({package:o,version:u,requiredBy:i.requiredBy,constraint:i.constraint}),o=i.requiredBy}else{console.warn(`\u26A0\uFE0F Could not find parent constraint for ${o}`);break}}return r}function tn(e,t,n){let r=[],s=n.constraints.get(e)||[],o=new Map;for(let a of s){let i=`${a.requiredBy}:${a.constraint}`;!o.has(i)&&a.requiredBy!=="user"&&o.set(i,{requiredBy:a.requiredBy,constraint:a.constraint,type:a.type||"dependency"})}return Array.from(o.values())}function nn(e){let t=e.match(/[\d]+\.[\d]+\.[\d]+/);return t?t[0]:e}function on(e){let t=`Dependency Constraints:

`;for(let[n,r]of e.constraints){t+=`${n}:
`;for(let s of r)t+=`  ${s.constraint} (required by: ${s.requiredBy})
`;t+=`
`}ne.textContent=t}window.toggleDependencyTree=function(){ne.style.display==="none"||!ne.style.display?ne.style.display="block":ne.style.display="none"};function je(e){let t=ct.querySelector("p");t&&(t.textContent=e)}function L(e,t,n=0,r=0,s=0){let o=document.getElementById("progressFill"),a=document.getElementById("progressStage"),i=document.getElementById("progressPackages"),c=document.getElementById("progressConstraints"),u=document.getElementById("progressTime");o&&(o.style.width=`${Math.min(100,Math.max(0,t))}%`),a&&(a.textContent=e),i&&(i.textContent=n.toString()),c&&(c.textContent=r.toString()),u&&(u.textContent=`${s}ms`)}function rn(){L("Initializing...",0,0,0,0)}function st(e){ct.style.display=e?"block":"none"}function sn(){Q.style.display="none"}function fe(e){oe.textContent="\u274C Error",Te.innerHTML=`<p><strong>Error:</strong> ${e}</p>`,Q.className="results error",Q.style.display="block"}function an(e){oe.textContent="\u2705 Success",Te.innerHTML=`<p><strong>Success:</strong> ${e}</p>`,Q.className="results success",Q.style.display="block"}function it(){Ae(),ge.children.length===0&&Pe(),console.log("\u{1F384} Perfect NPM Tree Updater initialized")}window.addPackageItem=Pe;window.removePackageItem=Ot;window.analyzeCompatibility=Xt;window.clearAllCaches=Rt;window.loadPackageExample=Nt;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",it):it();
//# sourceMappingURL=bundle.min.js.map
